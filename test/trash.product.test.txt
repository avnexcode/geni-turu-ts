describe('GET /api/v1/products', () => {
  it('responds with a JSON message', async () => {
    try {
      const products = await prisma.products.findMany();

      const response = await request(app)
        .get('/api/v1/products')
        .set('Accept', 'application/json')
        .set('Authorization', `Bearer ${token}`)
        .expect('Content-Type', /json/)
        .expect(200);

      expect(response.body).toEqual({
        status: 'Success',
        message: 'Success retrieve all products',
        data: expect.arrayContaining(
          products.map(product =>
            expect.objectContaining({
              id: product.id,
              name: product.name,
              price: product.price,
              category: product.category,
              description: product.description,
              image: product.image,
            })
          )
        ),
      });
    } catch (error) {
      throw error;
    }
  });
});
